\chapter{模式结构}\label{模式结构}
%\addcontentsline{toc}{chapter}{模式结构}

%\begin{模式结构}
CoLM陆面模式计算基本结构单元(次网格)为patch (斑块)，由patch可以组成按经纬度划分或按流域划分的网格，
在patch尺度计算得到的通量按其所在网格覆盖比例进行面积加权平均，作为地表通量模拟结果，与大气进行交换。
地表状态/预报变量亦是如此，在patch尺度计算得到的结果按照面积加权平均后作为模式结果输出。


Patch的类型可以分为植被(含裸土)、城市、湿地、冰川和水体五大类。其中植被和城市可根据不同类型进一步细分。


植被patch可以分为自然植被和作物。自然植被patch采用三种植被结构进行表征：地表覆盖类型-LCT、
植被功能型-PFT和植物群落-PC (模式运行时只能选其中1种)。LCT方案为CoLM原有方案，
把某一地表覆盖类型中的所有植被当成混合植被进行模拟，
其设置的相关参数可视为等效参数，如热带大草原，虽然可能包含树和草，但被当成一种植被看待，
因此相应的参数只有1套。PFT表征方式为目前陆面模式(如CLM和JULES)较多采用的方式，是本版CoLM新添加的方式。
PFT方案是将每一个细网格地表覆盖类型进行拆解，得到其PFT的组成种类和各自面积占比，分类聚合到模式网格。
目前采用CLM方案，模式格点中的所有PFT作为1个patch，即共享土壤水热环境，但PFT的辐射和通量等过程计算相对独立。
PC方案保留LCT方案模拟对象，即地表覆盖类型，同时也对LCT中的地表覆盖植被类型进行细分。
不同于LCT方案把某一类型地表覆盖的所有植被当成混合植被，PC方案对其所组成的PFT进行表达计算，所有PFT共享土壤水热环境，
辐射和通量计算等过程也是同时求解、相互影响，类似植物群落概念，故命名为PC (plant community)方案。


LCT方案所依赖的地表覆盖类型数据可以直接由USGS或MODIS-IGBP地表覆盖数据获取(章节 \ref{USGS地表覆盖数据} 和 \ref{IGBP地表覆盖数据}) 
。PFT和PC方案所需要的植被结构及属性数据由MODIS-IGBP地表覆盖数据加以其他辅助数据制作而成(章节 \ref{PFTPC数据及其依赖数据})。


对于作物patch，当作物模式未打开时，作物被当成一种特殊的自然植被进行模拟。当打开作物模式时，
每个模式格点根据包含的作物分类及组成比例(外部数据读取)分别建立相互独立的patch进行模拟计算。
城市patch与作物类似，当城市模式未打开时，城市被当成一种特殊的地表覆盖进行模拟。当城市模式打开时，
每个模式格点根据包含的城市类型和组成比例分别建立相互独立的patch进行模拟计算。目前城市分类有两种方案：
\begin{enumerate}
    \item 根据城市密度分为高建筑、高密度和中密度3类(基于NCAR CLMU城市模式);
    \item 根据城市局地气候区(LCZ)分为10类。
\end{enumerate}
城市分类及其属性数据从外部数据读取(章节 \ref{城市数据})。


